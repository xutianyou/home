<!DOCTYPE html>
<html>
<head>
  <title>闭包</title>
</head>
<body>
<script type="text/javascript">
/*
  1.全局变量不会被回收。
  2.局部变量会被回收，也就是函数一旦运行完以后，函数内部的东西都会被销毁。
  3.只要被另外一个作用域所引用就不会被回收
*/

// 闭包: 是指有权访问另一个函数作用域中的变量的函数，创建闭包的最常见的方式就是在一个函数内创建另一个函数，通过另一个函数访问这个函数的局部变量

/*
  闭包有三个特性

  1.函数嵌套函数
  2.函数内部可以引用外部的参数和变量
  3.参数和变量不会被垃圾回收机制回收
*/

/*
  闭包的好处：

  1.希望一个变量长期驻扎在内存中
  2.避免全局变量的污染
  3.私有成员的存在
*/
// 闭包的缺点就是: 常驻内存，会增大内存使用量，使用不当很容易造成内存泄露。

// 过度使用闭包会导致性能的下降。函数里放匿名函数，则产生了闭包


/* 面试答案
使用闭包主要是为了设计私有的方法和变量。闭包的优点是可以避免全局变量的污染，缺点是闭包会常驻内存，会增大内存使用量，使用不当很容易造成内存泄露。在js中，函数即闭包，只有函数才会产生作用域的概念

闭包有三个特性：

1.函数嵌套函数

2.函数内部可以引用外部的参数和变量

3.参数和变量不会被垃圾回收机制回收*/
function addCount() {
  var count = 0;
  return function() {
    count = count + 1;
    console.log(count);
  };
}

var fun1 = addCount();
fun1(); //1
fun1(); //2
fun1(); //3

var fun2 = addCount();
fun2(); //1
fun2(); //2

console.log('---------------------')
for (var i = 0; i < 4; i++) {
  setTimeout(function() {
    console.log(i);
  }, 300);
}

</script>
</body>
</html>